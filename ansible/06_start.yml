- name: Start Kafka
  hosts: kafka
  become: yes
  tasks:
    - name: Start Zookeeper
      when: inventory_hostname == "broker1-vm"
      command: /opt/kafka/bin/zookeeper-server-start.sh -daemon /opt/kafka/config/zookeeper.properties

    - name: Start Kafka broker
      command: /opt/kafka/bin/kafka-server-start.sh -daemon /opt/kafka/config/server.properties

- name: Start Flask
  hosts: flask
  become: yes
  tasks:
    - name: Run Flask app
      command: /opt/flask_app/venv/bin/python /opt/flask_app/app.py
      async: 10
      poll: 0

## Generated with the help of ChatGPT